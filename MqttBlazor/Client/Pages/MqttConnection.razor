@page "/mqttConnetct"
@inject MqttService _mqttService;
<h1>MQTT Messages</h1>

@if (_messages.Any())
{
    <ul>
        @foreach (var message in _messages)
        {
            <li>@message</li>
        }
    </ul>
}
else
{
    <p>No messages received yet</p>
}

@code {
    private List<string> _messages = new List<string>();

    protected override async Task OnInitializedAsync()
    {
        await _mqttService.ConnectMqttWebSocet("localhost:5109/mqtt");
        await _mqttService.SubscribeMqtt("Mohamed", OnMessageReceived);
    }

    private void OnMessageReceived(string message)
    {
        _messages.Add(message);
        StateHasChanged();
    }

}
